<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ page.title }} | Robert Beier</title>
  <link rel="icon" type="image/png" href="/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    /* 1. Theme Variables */
    :root {
      --bg: #ffffff;
      --text: #333333;
      --link: #5D3FD3;
      --border: #eeeeee;
      --shadow: rgba(0,0,0,0.1);
    }

    [data-theme="dark"] {
      --bg: #1a1a1a;
      --text: #f0f0f0; 
      --link: #a389f4; /* Lighter purple for dark mode contrast */
      --border: #333333;
      --shadow: rgba(0,0,0,0.5);
    }

    /* 2. Global Text Overrides - Fixes index.html visibility */
    body { 
      background-color: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
      line-height: 1.6; 
      max-width: 800px; 
      margin: 0 auto; 
      padding: 2rem; 
      transition: background-color 0.3s, color 0.3s;
    }

    /* This block forces every header, paragraph, and date to use theme colors */
    h1, h2, h3, h4, p, li, time, span, small {
        color: var(--text);
    }

    [data-theme="dark"] h1, 
    [data-theme="dark"] h2, 
    [data-theme="dark"] h3, 
    [data-theme="dark"] p, 
    [data-theme="dark"] li, 
    [data-theme="dark"] time,
    [data-theme="dark"] span,
    [data-theme="dark"] small {
        color: var(--text) !important;
    }

    /* 3. Links - Fixes "Read full post" and "Back to timeline" */
    a { 
      color: var(--link) !important; 
      text-decoration: none; 
      font-weight: bold;
    }
    
    a:hover {
      text-decoration: underline;
    }

    /* 4. Layout & UI Elements */
    img { max-width: 100%; height: auto; border-radius: 4px; cursor: pointer; }
    
    .mini-preview img { width: 23%; margin: 0.5%; aspect-ratio: 1/1; object-fit: cover; }
    
    .master-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; }
    
    nav { margin-bottom: 2rem; border-bottom: 1px solid var(--border); padding-bottom: 1rem; display: flex; justify-content: space-between; align-items: center; }
    
    /* Navigation specific links */
    nav a { margin-right: 15px; color: var(--link) !important; }
    
    .lightbox-target { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center; }
    .lightbox-target:target { display: flex; }
    .lightbox-target img { max-width: 90%; max-height: 90%; }
    
    article img { box-shadow: 0 4px 10px var(--shadow); }

    #theme-toggle {
      background: var(--bg);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 5px 12px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: bold;
    }
</style>
</head>
<body>

  <nav>
  <div>
    <a href="/">Timeline</a>
    <a href="/gallery">Gallery</a>
  </div>
  <button id="theme-toggle" aria-label="Toggle Dark Mode">üåô Dark Mode</button>
</nav>

  {{ content }}

  <script>
    // This script finds all images in your galleries and makes them clickable
    document.querySelectorAll('img').forEach(image => {
      image.onclick = () => {
        const overlay = document.createElement('div');
        overlay.style.cssText = "position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:1000;display:flex;align-items:center;justify-content:center;cursor:zoom-out;";
        const fullImg = document.createElement('img');
        fullImg.src = image.src;
        fullImg.style.maxHeight = '95%';
        overlay.appendChild(fullImg);
        document.body.appendChild(overlay);
        overlay.onclick = () => overlay.remove();
      };
    });
  </script>
<footer style="margin-top: 80px; padding: 40px 0; border-top: 1px solid var(--border); font-size: 0.9rem; text-align: center;">
  <p style="margin-bottom: 20px;">
    <a href="#" style="text-decoration: none;">‚Üë Back to Top</a>
  </p>
  
  <p style="opacity: 0.7;">
    &copy; {{ "now" | date: "%Y" }} Robert Beier. Hand-built with Jekyll.
  </p>
</footer>
<script>
  const toggle = document.getElementById('theme-toggle');
  const currentTheme = localStorage.getItem('theme');

  // 1. Check for saved user preference, if none, check system preference
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);
    if (currentTheme === 'dark') toggle.textContent = '‚òÄÔ∏è Light Mode';
  } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.setAttribute('data-theme', 'dark');
    toggle.textContent = '‚òÄÔ∏è Light Mode';
  }

  // 2. Listen for button click
  toggle.addEventListener('click', () => {
    let theme = document.documentElement.getAttribute('data-theme');
    if (theme === 'dark') {
      document.documentElement.setAttribute('data-theme', 'light');
      localStorage.setItem('theme', 'light');
      toggle.textContent = 'üåô Dark Mode';
    } else {
      document.documentElement.setAttribute('data-theme', 'dark');
      localStorage.setItem('theme', 'dark');
      toggle.textContent = '‚òÄÔ∏è Light Mode';
    }
  });
</script>
</body>
</html>
